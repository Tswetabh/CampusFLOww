{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile within the CampusFlow AI application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "year": {
          "type": "string",
          "description": "The user's academic year."
        },
        "branch": {
          "type": "string",
          "description": "The user's academic branch or major."
        },
        "hostel": {
          "type": "string",
          "description": "The user's hostel name."
        },
        "productivityScore": {
          "type": "number",
          "description": "The user's overall productivity score."
        },
        "academicRisk": {
          "type": "string",
          "description": "The user's current academic risk level (Low, Medium, High)."
        }
      },
      "required": [
        "id",
        "name",
        "year",
        "branch",
        "hostel",
        "productivityScore",
        "academicRisk"
      ]
    },
    "TimetableSlot": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TimetableSlot",
      "type": "object",
      "description": "Represents a single slot in a user's timetable.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the timetable slot."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N TimetableSlot)"
        },
        "day": {
          "type": "string",
          "description": "The day of the week for the timetable slot."
        },
        "subject": {
          "type": "string",
          "description": "The subject or class name for the timetable slot."
        },
        "startTime": {
          "type": "string",
          "description": "The start time of the timetable slot."
        },
        "endTime": {
          "type": "string",
          "description": "The end time of the timetable slot."
        },
        "status": {
          "type": "string",
          "description": "The status of the timetable slot (scheduled, cancelled)."
        }
      },
      "required": [
        "id",
        "userId",
        "day",
        "subject",
        "startTime",
        "endTime",
        "status"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task suggested by the AI productivity engine.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the task."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Task)"
        },
        "type": {
          "type": "string",
          "description": "The type of task (study, coding, wellness)."
        },
        "suggestion": {
          "type": "string",
          "description": "The AI-generated suggestion for the task."
        },
        "duration": {
          "type": "string",
          "description": "The suggested duration of the task."
        },
        "completed": {
          "type": "boolean",
          "description": "Indicates whether the task has been completed."
        }
      },
      "required": [
        "id",
        "userId",
        "type",
        "suggestion",
        "duration",
        "completed"
      ]
    },
    "AcademicMetrics": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AcademicMetrics",
      "type": "object",
      "description": "Represents a user's academic performance metrics.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the academic metrics record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 AcademicMetrics)"
        },
        "attendance": {
          "type": "number",
          "description": "The user's attendance percentage."
        },
        "assignmentsMissed": {
          "type": "number",
          "description": "The number of assignments missed by the user."
        },
        "stressLevel": {
          "type": "number",
          "description": "The user's self-reported stress level (1-5)."
        }
      },
      "required": [
        "id",
        "userId",
        "attendance",
        "assignmentsMissed",
        "stressLevel"
      ]
    },
    "HostelStatus": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "HostelStatus",
      "type": "object",
      "description": "Represents the current status of the hostel environment.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the hostel status record."
        },
        "laundryCrowdLevel": {
          "type": "string",
          "description": "The current laundry crowd level (Low, Medium, High)."
        },
        "messMenu": {
          "type": "string",
          "description": "The mess menu for the current day."
        },
        "noiseLevel": {
          "type": "string",
          "description": "The current noise level in the hostel."
        },
        "complaintStatus": {
          "type": "string",
          "description": "Status of any filed complaints"
        }
      },
      "required": [
        "id",
        "laundryCrowdLevel",
        "messMenu",
        "noiseLevel",
        "complaintStatus"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile data. Accessible only by the authenticated user. The 'userId' parameter must match 'request.auth.uid'.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, matching the Firebase Auth UID."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/timetableSlots/{timetableSlotId}",
        "definition": {
          "entityName": "TimetableSlot",
          "schema": {
            "$ref": "#/backend/entities/TimetableSlot"
          },
          "description": "Stores timetable slot data for a specific user. Only accessible by the authenticated user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, matching the Firebase Auth UID."
            },
            {
              "name": "timetableSlotId",
              "description": "The unique identifier for the timetable slot."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores AI-generated task suggestions for a specific user. Only accessible by the authenticated user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, matching the Firebase Auth UID."
            },
            {
              "name": "taskId",
              "description": "The unique identifier for the task."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/academicMetrics/{academicMetricsId}",
        "definition": {
          "entityName": "AcademicMetrics",
          "schema": {
            "$ref": "#/backend/entities/AcademicMetrics"
          },
          "description": "Stores academic performance metrics for a specific user. Only accessible by the authenticated user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, matching the Firebase Auth UID."
            },
            {
              "name": "academicMetricsId",
              "description": "The unique identifier for the academic metrics record."
            }
          ]
        }
      },
      {
        "path": "/hostelStatus/{hostelStatusId}",
        "definition": {
          "entityName": "HostelStatus",
          "schema": {
            "$ref": "#/backend/entities/HostelStatus"
          },
          "description": "Stores the current status of the hostel environment.",
          "params": [
            {
              "name": "hostelStatusId",
              "description": "The unique identifier for the hostel status record."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the CampusFlow AI application, focusing on optimizing student time usage, hostel life efficiency, and academic performance. The structure prioritizes authorization independence through path-based ownership and denormalization, ensuring secure and scalable data access. All collections are designed to support secure listing operations.\n\n*   **Users (Private Data):** User profiles are stored under `/users/{userId}`. This path-based ownership ensures that only the authenticated user can access their data. The `userId` is derived from `request.auth.uid`. AcademicMetrics are stored as a subcollection to the user document, allowing for easy retrieval of all user-related data. The HostelStatus data is stored at the root for all users to access.\n*   **Timetable Slots (User-Owned Data):** Timetable slots are stored as a subcollection under each user's document (`/users/{userId}/timetableSlots/{timetableSlotId}`). This hierarchical structure simplifies ownership-based security rules. The timetableSlots collections stores information about the user's timetable. The Task collections stores information about the AI generated task for the user.\n\nThis structure promotes clear security rules, avoids complex `get()` calls, and supports the application's core features efficiently."
  }
}